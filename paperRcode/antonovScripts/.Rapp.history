findInterval(2:18,c(3,10))
?fortune
fortune("This is R")
data.full<-read.csv("~/Dropbox/Work/matthijs-olivier/dpcr/cnvreplicates/Data/NIPD/NIPDmerged.csv")
subjects<-data.full[1:3,1]#
data.full<-data.full[,-1]#
subject<-1#
all.CNV<-list()#
#for(subject in 1:length(unique(subjects))){#
	cat("Subject",subject,"\n\n")#
	data<-data.full[(subject*3-2):(subject*3),]#
	#targets#
	CLIC6 <- cbind(c(rep("CLIC6",3)),data[,21],data[,22],c(rep(TRUE,3)))#
	DSCR3 <- cbind(c(rep("DSCR3",3)),data[,15],data[,16],c(rep(TRUE,3)))#
	SYNJ1 <- cbind(c(rep("SYNJ1",3)),data[,25],data[,26],c(rep(TRUE,3)))#
	AMELX <- cbind(c(rep("AMELX",3)),data[,1],data[,2],c(rep(TRUE,3)))#
	AMELY <- cbind(c(rep("AMELY",3)),data[,17],data[,18],c(rep(TRUE,3)))#
	ATP11C <- cbind(c(rep("ATP11C",3)),data[,11],data[,12],c(rep(TRUE,3)))#
	IL13RA1 <- cbind(c(rep("IL13RA1",3)),data[,5],data[,6],c(rep(TRUE,3)))#
	SRY <- cbind(c(rep("SRY",3)),data[,23],data[,24],c(rep(TRUE,3)))#
#
	#references#
	C18ORF62 <- cbind(c(rep("C18ORF62",3)),data[,19],data[,20],c(rep(FALSE,3)))#
	ITGBL1 <- cbind(c(rep("ITGBL1",3)),data[,13],data[,14],c(rep(FALSE,3)))#
	LAMA3 <- cbind(c(rep("LAMA3",3)),data[,3],data[,4],c(rep(FALSE,3)))#
	LNX2 <- cbind(c(rep("LNX2",3)),data[,7],data[,8],c(rep(FALSE,3)))#
	SMCHD1 <- cbind(c(rep("SMCHD1",3)),data[,9],data[,10],c(rep(FALSE,3)))#
	RPP30 <- cbind(c(rep("RPP30",3)),data[,27],data[,28],c(rep(FALSE,3)))#
#
	#dataframe#
	datamat<-data.frame(rbind(CLIC6,DSCR3,SYNJ1,AMELX,AMELY,ATP11C,IL13RA1,SRY,C18ORF62,ITGBL1,LAMA3,LNX2,SMCHD1,RPP30))#
	colnames(datamat)<-c("gene","pos","neg","target")#
	datamat$gene<-as.character(datamat$gene)#
	datamat$pos<-as.numeric(as.character(datamat$pos))#
	datamat$neg<-as.numeric(as.character(datamat$neg))#
	datamat$target<-as.logical(datamat$target)#
	datamat<-datamat[!is.na(datamat$pos),]
data.full<-read.csv("~/Dropbox/Work/matthijs-olivier/dpcr/cnvreplicates/Data/NIPD/NIPDmerged.csv",sep=";")
subjects<-data.full[1:3,1]#
data.full<-data.full[,-1]#
subject<-1#
all.CNV<-list()#
#for(subject in 1:length(unique(subjects))){#
	cat("Subject",subject,"\n\n")#
	data<-data.full[(subject*3-2):(subject*3),]#
	#targets#
	CLIC6 <- cbind(c(rep("CLIC6",3)),data[,21],data[,22],c(rep(TRUE,3)))#
	DSCR3 <- cbind(c(rep("DSCR3",3)),data[,15],data[,16],c(rep(TRUE,3)))#
	SYNJ1 <- cbind(c(rep("SYNJ1",3)),data[,25],data[,26],c(rep(TRUE,3)))#
	AMELX <- cbind(c(rep("AMELX",3)),data[,1],data[,2],c(rep(TRUE,3)))#
	AMELY <- cbind(c(rep("AMELY",3)),data[,17],data[,18],c(rep(TRUE,3)))#
	ATP11C <- cbind(c(rep("ATP11C",3)),data[,11],data[,12],c(rep(TRUE,3)))#
	IL13RA1 <- cbind(c(rep("IL13RA1",3)),data[,5],data[,6],c(rep(TRUE,3)))#
	SRY <- cbind(c(rep("SRY",3)),data[,23],data[,24],c(rep(TRUE,3)))#
#
	#references#
	C18ORF62 <- cbind(c(rep("C18ORF62",3)),data[,19],data[,20],c(rep(FALSE,3)))#
	ITGBL1 <- cbind(c(rep("ITGBL1",3)),data[,13],data[,14],c(rep(FALSE,3)))#
	LAMA3 <- cbind(c(rep("LAMA3",3)),data[,3],data[,4],c(rep(FALSE,3)))#
	LNX2 <- cbind(c(rep("LNX2",3)),data[,7],data[,8],c(rep(FALSE,3)))#
	SMCHD1 <- cbind(c(rep("SMCHD1",3)),data[,9],data[,10],c(rep(FALSE,3)))#
	RPP30 <- cbind(c(rep("RPP30",3)),data[,27],data[,28],c(rep(FALSE,3)))#
#
	#dataframe#
	datamat<-data.frame(rbind(CLIC6,DSCR3,SYNJ1,AMELX,AMELY,ATP11C,IL13RA1,SRY,C18ORF62,ITGBL1,LAMA3,LNX2,SMCHD1,RPP30))#
	colnames(datamat)<-c("gene","pos","neg","target")#
	datamat$gene<-as.character(datamat$gene)#
	datamat$pos<-as.numeric(as.character(datamat$pos))#
	datamat$neg<-as.numeric(as.character(datamat$neg))#
	datamat$target<-as.logical(datamat$target)#
	datamat<-datamat[!is.na(datamat$pos),]
datamat
ref.data<-datamat[datamat$target==F,]#
	ref.genes<-unique(ref.data$gene)
load('~/Dropbox/Work/matthijs-olivier/dpcr/cnvreplicates/Data/NIPD/refGeneStability.RData')
ls()
stability
stab.genes
load('~/Downloads/refGeneStability05_sample.RData')
ls()
stab.genes
stability
load('~/Dropbox/Work/matthijs-olivier/dpcr/cnvreplicates/Data/NIPD/figures/refGeneStability/refGeneStability09_sample.RData')
stability
stab.summary
stab.genes
determine.stability <- function(datamat){#
#
	ref.data<-datamat[datamat$target==F,]#
	ref.genes<-unique(ref.data$gene)#
	est<-array(NA,(length(ref.genes)-1))#
	est.low<-array(NA,(length(ref.genes)-1))#
	est.high<-array(NA,(length(ref.genes)-1))#
	gene<-array(NA,(length(ref.genes)-1))#
	stability <- data.frame(gene,est,est.low,est.high)#
	stab.genes<-list()#
	stab.summary<-matrix(NA,length(ref.genes),2)#
	for(i in 1:length(ref.genes)){#
		cat("Determining stability...\n\tReference gene ",i," of ",length(ref.genes),"\n\n")#
		target.ref.ID <- which(ref.data$gene==ref.genes[i])#
		target.ref.data <- ref.data[target.ref.ID,]#
		target.ref.data$target <- TRUE#
		ref.ref.data <- ref.data[-target.ref.ID,]#
		ref.ref.genes<-unique(ref.ref.data$gene)			#
		for(j in 1:length(ref.ref.genes)){#
			ref.ref.ID <- which(ref.ref.data$gene==ref.ref.genes[j])#
			data.subset <- rbind(target.ref.data,ref.ref.data[ref.ref.ID,])#
			#stability[j,]<-get.estimates(data.subset,fit.set(data.subset))#
			stability[j,]<-get.estimates.stab(data.subset,fit.set(data.subset))#
		}#
		stab.genes[[i]]<-stability#
		#stab.summary[i,]<-c(mean(stab.genes[[i]]$est),sum((stab.genes[[i]]$est-2)^2))#
		stab.summary[i,]<-c(mean(stab.genes[[i]]$est),mean(stab.genes[[i]]$est^2+stab.genes[[i]]$est.var))#
	}#
	stab.summary<-data.frame(as.character(ref.genes),stab.summary)#
	colnames(stab.summary)<-c("Gene","Mean","Deviation")#
	return(list(stab.genes,stab.summary))#
}#
get.estimates.stab <- function(datamat,model.fit){#
	genenames<-as.character(unique(datamat$gene[datamat$target==T]))#
	est<-array(0,length(model.fit))#
	est.var<-array(0,length(model.fit))#
#
	est.list<-data.frame(genenames,est,est.var)#
	est.list[1,2]<-model.fit@beta[2]#
	est.list[1,3]<-vcov(model.fit)[2,2]	#
	return(est.list)#
}
datamat
ref.data<-datamat[datamat$target==F,]#
	ref.genes<-unique(ref.data$gene)#
	est<-array(NA,(length(ref.genes)-1))#
	est.low<-array(NA,(length(ref.genes)-1))#
	est.high<-array(NA,(length(ref.genes)-1))#
	gene<-array(NA,(length(ref.genes)-1))#
	stability <- data.frame(gene,est,est.low,est.high)#
	stab.genes<-list()#
	stab.summary<-matrix(NA,length(ref.genes),2)
stab.genes
i<-1
cat("Determining stability...\n\tReference gene ",i," of ",length(ref.genes),"\n\n")#
		target.ref.ID <- which(ref.data$gene==ref.genes[i])#
		target.ref.data <- ref.data[target.ref.ID,]#
		target.ref.data$target <- TRUE#
		ref.ref.data <- ref.data[-target.ref.ID,]#
		ref.ref.genes<-unique(ref.ref.data$gene)			#
		for(j in 1:length(ref.ref.genes)){#
			ref.ref.ID <- which(ref.ref.data$gene==ref.ref.genes[j])#
			data.subset <- rbind(target.ref.data,ref.ref.data[ref.ref.ID,])#
			#stability[j,]<-get.estimates(data.subset,fit.set(data.subset))#
			stability[j,]<-get.estimates.stab(data.subset,fit.set(data.subset))#
		}
library(lme4)
cat("Determining stability...\n\tReference gene ",i," of ",length(ref.genes),"\n\n")#
		target.ref.ID <- which(ref.data$gene==ref.genes[i])#
		target.ref.data <- ref.data[target.ref.ID,]#
		target.ref.data$target <- TRUE#
		ref.ref.data <- ref.data[-target.ref.ID,]#
		ref.ref.genes<-unique(ref.ref.data$gene)			#
		for(j in 1:length(ref.ref.genes)){#
			ref.ref.ID <- which(ref.ref.data$gene==ref.ref.genes[j])#
			data.subset <- rbind(target.ref.data,ref.ref.data[ref.ref.ID,])#
			#stability[j,]<-get.estimates(data.subset,fit.set(data.subset))#
			stability[j,]<-get.estimates.stab(data.subset,fit.set(data.subset))#
		}
stability
ref.genes
stab.genes[[i]]<-stability
stab.genes[[i]]$est^2
stab.genes[[i]]$est.low
stab.genes[[i]]$est^2+stab.genes[[i]]$est.low
stability
abs(stability[[2]][,3])
abs(stability[,3])
order(abs(stability[,3]))
order(abs(stability[,3]),decreasing=T)
data.tutorial <- read.csv("http://users.ugent.be/~mvynck/glmm/tutorial.csv")
data.tutorial <- read.csv("http://users.ugent.be/~mvynck/glmm/tutorial.csv")
http://users.ugent.be/~mvynck/glmm/tutorial.csv
data.tutorial <- read.csv("http://users.ugent.be/~mvynck/glmm/tutorial.csv")
head(data.tutorial)#
#
#install.packages("lme4")#
source("http://users.ugent.be/~mvynck/glmm/glmmfunctions.R")#
#
colnames(data.tutorial)<-c("gene","pos","neg","target")#
data.tutorial$gene<-as.character(data.tutorial$gene)#
data.tutorial$pos<-as.numeric(as.character(data.tutorial$pos))#
data.tutorial$neg<-as.numeric(as.character(data.tutorial$neg))#
data.tutorial$target<-as.logical(data.tutorial$target)#
#
fit.example1 <- fit.set(data.tutorial[1,])#
(example1 <- get.estimates(data.tutorial[1,],fit.example1))#
#
fit.example2 <- fit.set(data.tutorial[1:3,])#
(example2 <- get.estimates(data.tutorial[1:3,],fit.example2))#
#
fit.example3 <- fit.set(data.tutorial[1:4,])#
(example3 <- get.estimates(data.tutorial[1:4,],fit.example3))#
#
fit.example4 <- fit.set(data.tutorial[c(1:4,23:25),])#
(example4 <- get.estimates(data.tutorial[1:4,],fit.example4))
CNV.est
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")
load("decreasingStability/refGeneStability05_sample.RData")
CNV.est
par(mfrow=c(1,2))#
	MAD<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation")#
	uncertainty<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty)*1.1),xlab="Number of reference genes",ylab="Confidence interval width")#
	integer<-array(0,length(ref.genes))
load("increasingStability/refGeneStability05_sample.RData")
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(1,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}
MAD
MAD.stable
max(MAD,MAD.stable)
plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(1,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(1,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability16_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability16_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability16_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability16_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability18_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability18_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5)#
	lines(MAD.stable,lty=3,lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5)#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col="green")#
	lines(MAD.stable,lty=3,lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5)#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col="darkgreen")#
	lines(MAD.stable,lty=3,lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5)#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col="darkgreen")#
	lines(MAD.stable,lty=3,lwd=1.5,col="darkblue")#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5)#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
library(RColorBrewer)
brewer.pal(1,"Set1")
brewer.pal(3,"Set1")[1]
brewer.pal(3,"Set1")[2]
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[1])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5)#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5)#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2)#
	lines(MAD.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2)#
	lines(uncertainty.stable,lty=3)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5)#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2])#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,col=brewer.pal(3,"Set1")[2])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),col=c(brewer.pal(3,"Set1")[3]),brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2])#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2))
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5)#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5)#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(MAD.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]),lwd=1.5)#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
	par(mfrow=c(2,2))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(MAD.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]),lwd=1.5)#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))
stability
plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
stability.stable <- stability#
load("increasingStability/refGeneStability05_sample.RData")#
#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],border=brewer.pal(3,"Set1")[2]))#
}#
#
par(mfrow=c(2,1))#
plot.stability(stability)#
plot.stability(stability.stable)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
stability.stable <- stability#
load("increasingStability/refGeneStability05_sample.RData")#
#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2])#
}#
#
par(mfrow=c(2,1))#
plot.stability(stability)#
plot.stability(stability.stable)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("increasingStability/refGeneStability05_sample.RData")#
stability.stable <- stability#
load("increasingStability/refGeneStability18_sample.RData")#
#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2])#
}#
#
par(mfrow=c(2,1))#
plot.stability(stability)#
plot.stability(stability.stable)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("increasingStability/refGeneStability05_sample.RData")#
stability.stable <- stability#
load("increasingStability/refGeneStability18_sample.RData")#
#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=brewer.pal(3,"Set1")[2]))#
}#
#
par(mfrow=c(2,1))#
plot.stability(stability)#
plot.stability(stability.stable)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("increasingStability/refGeneStability05_sample.RData")#
stability.stable <- stability#
load("increasingStability/refGeneStability18_sample.RData")#
#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA)#
}#
#
par(mfrow=c(2,1))#
plot.stability(stability)#
plot.stability(stability.stable)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("increasingStability/refGeneStability05_sample.RData")#
stability.stable <- stability#
load("increasingStability/refGeneStability18_sample.RData")#
#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability")#
}#
#
par(mfrow=c(2,1))#
plot.stability(stability)#
plot.stability(stability.stable)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("increasingStability/refGeneStability05_sample.RData")#
stability.stable <- stability#
load("increasingStability/refGeneStability18_sample.RData")#
#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene")#
}#
#
par(mfrow=c(2,1))#
plot.stability(stability)#
plot.stability(stability.stable)
library(RColorBrewer)#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene")#
}#
#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
#
	plot.stability(stability)
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene")#
}
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene")#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene")#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
#
	plot.stability(stability)#
#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(MAD.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]),lwd=1.5)#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene")#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene")#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
#
	plot.stability(stability)
?barplot
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene"las=1)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=1)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
#
	plot.stability(stability)
?par
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2))#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,5,4,2))#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2))#
	plot.stability(stability)
?par
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2))#
	par(mgp[2]=c(4,1,0))#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2))#
	par(mgp[2]=c(4,3,0))#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2))#
	par(mgp[2,3]=c(4,3,0))#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2))#
	par(mgp[2,3]=c(4,3,2))#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2),mgp=c(4,1,0))#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2),mgp[2]=c(5,1,0))#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2),mgp=c(6,1,0))#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)
par()
par(mar())
?par
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1),mar=c(5,4,4,2,mgp=c(3,1,0)))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1),mar=c(5,4,4,2,mgp=c(1,1,0)))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)
resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
}
par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(5,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(5,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2,xaxt="n")#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2,xaxt="n")#
	tck<-axis(1,labels=FALSE)#
	labels<-stability[[2]][,1][order(abs(stability[[2]][,3]))]#
	text(tck, par("usr")[3], labels=labels, srt=315,#
     xpd=TRUE)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2,xaxt="n")#
	tck<-axis(1,labels=FALSE)#
	labels<-stability[[2]][,1][order(abs(stability[[2]][,3]))]#
	text(tck, par("usr")[3], labels=labels, srt=360,#
     xpd=TRUE)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2,xaxt="n")#
	tck<-axis(1,labels=FALSE)#
	labels<-stability[[2]][,1][order(abs(stability[[2]][,3]))]#
	text(tck, par("usr")[3], labels=labels, srt=90,#
     xpd=TRUE)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2,xaxt="n")#
	tck<-axis(1,labels=FALSE)#
	labels<-stability[[2]][,1][order(abs(stability[[2]][,3]))]#
	text(tck, labels=labels, srt=90,#
     xpd=TRUE)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2,xaxt="n")#
	tck<-axis(1,labels=FALSE)#
	labels<-stability[[2]][,1][order(abs(stability[[2]][,3]))]#
	text(tck, par("usr")[3], labels=labels, srt=90,#
     xpd=TRUE)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
stability[[2]][,1][order(abs(stability[[2]][,3]))]
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2,xaxt="n")#
	tck<-axis(1,labels=FALSE)#
	labels<-stability[[2]][,1][order(abs(stability[[2]][,3]))]#
	text(tck, par("usr")[4], labels=labels, srt=90,#
     xpd=TRUE)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2,xaxt="n")#
	tck<-axis(1,labels=FALSE)#
	labels<-stability[[2]][,1][order(abs(stability[[2]][,3]))]#
	text(tck, par("usr")[3], labels=labels, srt=90)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,4,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,3,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,5,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(7,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5,cex=0.9)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
#
sample<-c(5,6,16,20,19,9,18,15,13)#
single<-c(0.1130,0.0778,0.0544,0.0363,0.1324,0.0695,0.1447,0.4053,0.7837)#
multiple<-c(0.1104,0.0645,0.0331,0.0251,0.0293,0.2051,0.1111,0.0990,0.1529)#
performance<-data.frame(sample,single,multiple)#
performance<-performance[order(performance$sample),]#
#
barplot(t(as.matrix(performance[,2:3])),beside=T,xlab="Sample",ylab="Mean absolute deviance from integer copy numbers",col=gray.colors(2),ylim=c(0,0.8),names.arg=performance[,1],border=NA)#
legend("topright",c("Single reference gene","Multiple reference genes"),bty="n",fill=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))
library(RColorBrewer)#
#
sample<-c(5,6,16,20,19,9,18,15,13)#
single<-c(0.1130,0.0778,0.0544,0.0363,0.1324,0.0695,0.1447,0.4053,0.7837)#
multiple<-c(0.1104,0.0645,0.0331,0.0251,0.0293,0.2051,0.1111,0.0990,0.1529)#
performance<-data.frame(sample,single,multiple)#
performance<-performance[order(performance$sample),]#
#
barplot(t(as.matrix(performance[,2:3])),beside=T,xlab="Sample",ylab="Mean absolute deviance from integer copy numbers",col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]),ylim=c(0,0.8),names.arg=performance[,1],border=NA)#
legend("topright",c("Single reference gene","Multiple reference genes"),bty="n",fill=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))
legend("topright",c("Single reference gene","Multiple reference genes"),bty="n",fill=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]),border=NA)
library(RColorBrewer)#
#
sample<-c(5,6,16,20,19,9,18,15,13)#
single<-c(0.1130,0.0778,0.0544,0.0363,0.1324,0.0695,0.1447,0.4053,0.7837)#
multiple<-c(0.1104,0.0645,0.0331,0.0251,0.0293,0.2051,0.1111,0.0990,0.1529)#
performance<-data.frame(sample,single,multiple)#
performance<-performance[order(performance$sample),]#
#
barplot(t(as.matrix(performance[,2:3])),beside=T,xlab="Sample",ylab="Mean absolute deviance from integer copy numbers",col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]),ylim=c(0,0.8),names.arg=performance[,1],border=NA)#
legend("topright",c("Single reference gene","Multiple reference genes"),bty="n",fill=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]),border=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2,bty="n")#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
#
sample<-c(5,6,16,20,19,9,18,15,13)#
single<-c(0.1130,0.0778,0.0544,0.0363,0.1324,0.0695,0.1447,0.4053,0.7837)#
multiple<-c(0.1104,0.0645,0.0331,0.0251,0.0293,0.2051,0.1111,0.0990,0.1529)#
performance<-data.frame(sample,single,multiple)#
performance<-performance[order(performance$sample),]#
#
barplot(t(as.matrix(performance[,2:3])),beside=T,xlab="Sample",ylab="Mean absolute deviance from integer copy numbers",col=c(brewer.pal(3,"Set1")[2],brewer.pal(3,"Set1")[3]),ylim=c(0,0.8),names.arg=performance[,1],border=NA)#
legend("topright",c("Single reference gene","Multiple reference genes"),bty="n",fill=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]),border=c(brewer.pal(3,"Set1")[2],brewer.pal(3,"Set1")[3]))
library(RColorBrewer)#
#
sample<-c(5,6,16,20,19,9,18,15,13)#
single<-c(0.1130,0.0778,0.0544,0.0363,0.1324,0.0695,0.1447,0.4053,0.7837)#
multiple<-c(0.1104,0.0645,0.0331,0.0251,0.0293,0.2051,0.1111,0.0990,0.1529)#
performance<-data.frame(sample,single,multiple)#
performance<-performance[order(performance$sample),]#
#
barplot(t(as.matrix(performance[,2:3])),beside=T,xlab="Sample",ylab="Mean absolute deviance from integer copy numbers",col=c(brewer.pal(3,"Set1")[2],brewer.pal(3,"Set1")[3]),ylim=c(0,0.8),names.arg=performance[,1],border=NA)#
legend("topright",c("Single reference gene","Multiple reference genes"),bty="n",fill=c(brewer.pal(3,"Set1")[2],brewer.pal(3,"Set1")[3]),border=c(brewer.pal(3,"Set1")[2],brewer.pal(3,"Set1")[3]))
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability06_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability06_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability06_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability06_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability09_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability09_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability13_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability13_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability15_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability15_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability18_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability18_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability20_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability20_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(1,3))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(1,3))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(1,3))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(1,3))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(1,3))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(2,3))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())#
#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	#par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(2,3))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)
par(resetPar())
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	#par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)
library(RColorBrewer)#
#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(2,3))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
par(mfrow=c(2,3))
MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)
library(RColorBrewer)#
#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(2,3))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}
MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)
par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(2,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(2,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1.2),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1.2),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability13_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability13_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
stability
stability[[1]]
stability[[1]][[6]]
stability[[1]][[6]]$est^2
load("decreasingStability/refGeneStability05_sample.RData")
stability[[1]][[6]]$est^2
stability
stability[[1]][[6]]$est^2
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability20_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability20_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability16_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability16_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability20_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability20_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability15_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability15_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
load("increasingStability/refGeneStability9_sample.RData")
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability09_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability09_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability05_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability05_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability06_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability06_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability09_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability09_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability13_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability13_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability15_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability15_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability16_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability16_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability18_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability18_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability19_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability19_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability20_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability20_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
CNV.est
CNV.est[[6]]
CNV.est.stable[[6]]
library(RColorBrewer)#
setwd("/Users/mvynck/Dropbox/Work/Matthijs-Olivier/dPCR/CNVReplicates/Rcode/NIPDdataJo/antonovScripts/")#
load("decreasingStability/refGeneStability20_sample.RData")#
CNV.est.stable <- CNV.est#
load("increasingStability/refGeneStability20_sample.RData")#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))],col=brewer.pal(3,"Set1")[2],border=NA,ylab="Stability",xlab="Reference gene",las=2)#
}#
#
	par(mfrow=c(3,1))#
	MAD<-array(0,length(ref.genes))#
	MAD.stable<-array(0,length(ref.genes))#
#
	for(i in 1:length(ref.genes)){#
		MAD[i]<-mean(abs(CNV.est[[i]][,2]-round(CNV.est[[i]][,2])))#
		MAD.stable[i]<-mean(abs(CNV.est.stable[[i]][,2]-round(CNV.est.stable[[i]][,2])))#
#
	}#
	plot(MAD,type="l",ylim=c(0,max(MAD,MAD.stable)*1),xlab="Number of reference genes",ylab="Mean absolute deviation",lty=2,lwd=1.5,col=brewer.pal(3,"Set1")[2])#
	lines(MAD.stable,lty=3,lwd=1.5,col=brewer.pal(3,"Set1")[3])#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	uncertainty<-array(0,length(ref.genes))#
	uncertainty.stable<-array(0,length(ref.genes))#
	for(i in 1:length(ref.genes)){#
		uncertainty[i]<-mean(CNV.est[[i]][,4]-CNV.est[[i]][,3])#
		uncertainty.stable[i]<-mean(CNV.est.stable[[i]][,4]-CNV.est.stable[[i]][,3])#
	}#
	plot(uncertainty,type="l",ylim=c(0,max(uncertainty,uncertainty.stable)*1),xlab="Number of reference genes",ylab="Width of 95% confidence interval",lty=2,col=brewer.pal(3,"Set1")[2],lwd=1.5)#
	lines(uncertainty.stable,lty=3,col=brewer.pal(3,"Set1")[3],lwd=1.5)#
	legend("topright",c("Best case","Worst case"),lty=c(3,2),lwd=1.5,col=c(brewer.pal(3,"Set1")[3],brewer.pal(3,"Set1")[2]))#
	par(mar=c(6,6,4,2),mgp=c(5,1,0))#
	plot.stability(stability)#
	resetPar <- function() {#
    dev.new()#
    op <- par(no.readonly = TRUE)#
    dev.off()#
    op#
	}#
	par(resetPar())
#gene name;	pos;	neg;	ref;	target;	repl;#
library(lme4)#
#
data<-read.csv("NIPDmerged.csv",sep=";")#
data<-data[1:3,-1]#
#
#targets#
CLIC6 <- cbind(c(rep("CLIC6",3)),data[,21],data[,22],c(rep(0,3)),c(rep(1,3)),c(1:3))#
DSCR3 <- cbind(c(rep("DSCR3",3)),data[,15],data[,16],c(rep(0,3)),c(rep(2,3)),c(1:3))[-3,]#
SYNJ1 <- cbind(c(rep("SYNJ1",3)),data[,25],data[,26],c(rep(0,3)),c(rep(3,3)),c(1:3))#
AMELX <- cbind(c(rep("AMELX",3)),data[,1],data[,2],c(rep(0,3)),c(rep(4,3)),c(1:3))#
AMELY <- cbind(c(rep("AMELY",3)),data[,17],data[,18],c(rep(0,3)),c(rep(5,3)),c(1:3))[-3,]#
ATP11C <- cbind(c(rep("ATP11C",3)),data[,11],data[,12],c(rep(0,3)),c(rep(6,3)),c(1:3))#
IL13RA1 <- cbind(c(rep("IL13RA1",3)),data[,5],data[,6],c(rep(0,3)),c(rep(7,3)),c(1:3))#
SRY <- cbind(c(rep("SRY",3)),data[,23],data[,24],c(rep(0,3)),c(rep(8,3)),c(1:3))#
#
#references#
C18ORF62 <- cbind(c(rep("C18ORF62",3)),data[,19],data[,20],c(rep(1,3)),c(rep(0,3)),c(1:3))[-3,]#
ITGBL1 <- cbind(c(rep("ITGBL1",3)),data[,13],data[,14],c(rep(2,3)),c(rep(0,3)),c(1:3))[-3,]#
LAMA3 <- cbind(c(rep("LAMA3",3)),data[,3],data[,4],c(rep(3,3)),c(rep(0,3)),c(1:3))#
LNX2 <- cbind(c(rep("LNX2",3)),data[,7],data[,8],c(rep(4,3)),c(rep(0,3)),c(1:3))#
SMCHD1 <- cbind(c(rep("SMCHD1",3)),data[,9],data[,10],c(rep(4,3)),c(rep(0,3)),c(1:3))#
#
#dataframe#
datamat<-data.frame(rbind(CLIC6,DSCR3,SYNJ1,AMELX,AMELY,ATP11C,IL13RA1,SRY,C18ORF62,ITGBL1,LAMA3,LNX2,SMCHD1))#
colnames(datamat)<-c("gene","pos","neg","ref","target","repl")#
datamat$pos<-as.numeric(as.character(datamat$pos))#
datamat$neg<-as.numeric(as.character(datamat$neg))#
datamat<-datamat[,c(1,2,3,5)]#
datamat$target<-datamat$target!="0"#
generate.df <- function(datamat){#
	cat("Converting data ...\n")#
	#target#
	target.df <- datamat[datamat$target==T,]#
	if(nrow(target.df)!=0){#
	ID<-letters[1]#
	Y <- c(rep(1,sum(target.df$pos)),rep(0,sum(target.df$neg)))#
	target <- rep("yes",sum(c(target.df$pos,target.df$neg)))#
	sample <- rep(ID,sum(c(target.df$pos,target.df$neg)))#
	repl<-NULL#
	for(i in 1:nrow(target.df)){#
		repl<-c(repl,rep(paste(ID,i,sep=""),target.df$pos[i]))#
	}#
	for(i in 1:nrow(target.df)){#
		repl<-c(repl,rep(paste(ID,i,sep=""),target.df$neg[i]))#
	}#
	db<-data.frame(Y,target,sample,repl)#
	}#
	#reference#
	ref.df<-datamat[datamat$target==F,]#
	if(nrow(ref.df)!=0){#
		for(i in 2:length(unique(datamat$gene))){#
			ID<-letters[i]#
			ref.df.subset <- ref.df[which(ref.df$gene==unique(ref.df$gene)[i-1]),]#
			Y <- c(rep(1,sum(ref.df.subset$pos)),rep(0,sum(ref.df.subset$neg)))#
			target <- rep("no",sum(c(ref.df.subset$pos,ref.df.subset$neg)))#
			sample <- rep(ID,sum(c(ref.df.subset$pos,ref.df.subset$neg)))#
			repl<-NULL#
			for(j in 1:nrow(ref.df.subset)){#
				repl<-c(repl,rep(paste(ID,j,sep=""),ref.df.subset$pos[j]))#
			}#
			for(j in 1:nrow(ref.df.subset)){#
				repl<-c(repl,rep(paste(ID,j,sep=""),ref.df.subset$neg[j]))#
			}	#
			db2<-data.frame(Y,target,sample,repl)#
			db<-rbind(db,db2)#
		}#
	}#
	return(db)#
}#
fit.GLMM <- function(datamat){#
	#target#
	db <- generate.df(datamat)#
	model.rand<-NULL#
	type<-length(unique(datamat$gene))>1#
	repl<-max(table(datamat$gene))>1#
	cat("Fitting model: \n")#
	n.ref<-length(unique(datamat$gene[datamat$target==F]))#
	mult.ref<-n.ref>1#
	if(mult.ref&&type){cat("\tmultiple (n=", n.ref ,") reference genes\n",sep="")}else if(type&&!mult.ref){cat("\tsingle reference gene\n")}#
	if(type==T&&repl==T){#
		cat("\tcopy number variation\n\twith replicates ... \n")#
		model.rand<-glmer(Y~target+(1|repl)+(1|sample),data=db,family=binomial(cloglog),nAGQ=1,verbose=F)#
	} else if(type==T&&repl==F) {#
		cat("\tcopy number variation\n\twithout replicates ... \n")#
		model.rand<-glmer(Y~target+(1|sample),data=db,family=binomial(cloglog),nAGQ=1,verbose=F)	#
	} else if(type==F&&repl==T){#
		cat("\tabsolute quantification\n\twith replicates ... \n")#
		model.rand<-glmer(Y~1+(1|repl),data=db,family=binomial(cloglog),nAGQ=1,verbose=F)#
	} else if(type==F&&repl==F){#
		cat("\tabsolute quantification\n\twithout replicates ... \n")#
		model.rand<-glm(Y~1,data=db,family=binomial(cloglog))		#
	}#
	return(model.rand)#
}#
#
fit.set <- function(datamat){#
	n.target<-length(unique(datamat$gene[datamat$target==T]))#
	if(n.target>1){#
		#multiple targets#
		cat("Analyzing multiple targets ... \n")#
		model.fit<-vector("list",n.target)#
		for(i in 1:n.target){#
			target.name<-as.character(unique(datamat$gene[datamat$target==T])[i])#
			cat("Analyzing target ", i, " of ", n.target," (",target.name,") ...\n",sep="")#
			datamat.temp <- rbind(datamat[datamat$gene==target.name,],datamat[datamat$target==F,])#
			model.fit[[i]]<-fit.GLMM(datamat.temp)#
			cat("\n\n")#
		}#
	} else if (n.target==1){#
		#single target#
		cat("Analyzing single target ... \n")#
		model.fit<-fit.GLMM(datamat)#
	} else {#
		cat("No target\n")#
	}#
	return(model.fit)#
}#
#
get.estimates <- function(datamat,model.fit){#
	genenames<-as.character(unique(datamat$gene[datamat$target==T]))#
	est<-array(0,length(model.fit))#
	est.low<-array(0,length(model.fit))#
	est.high<-array(0,length(model.fit))#
#
	est.list<-data.frame(genenames,est,est.low,est.high)#
	#multiple models#
	if(is(model.fit)[1]!="glmerMod"&&is(model.fit)[1]!="glm"){#
		for(i in 1:length(model.fit)){#
			model.rand <- model.fit[[i]]#
			if(is(model.fit[[i]])[1]=="glmerMod"){#
				if(dim(vcov(model.rand))[1]==1){#
					#absolute quantification#
					est.list[i,2]<-(exp(-model.rand@beta[1]))*2#
					est.list[i,3]<-(exp(-model.rand@beta[1]-1.96*sqrt(vcov(model.rand)[1,1])))*2#
					est.list[i,4]<-(exp(-model.rand@beta[1]+1.96*sqrt(vcov(model.rand)[1,1])))*2					#
				} else {#
					#copy number variation#
					est.list[i,2]<-(exp(-model.rand@beta[2]))*2#
					est.list[i,3]<-(exp(-model.rand@beta[2]-1.96*sqrt(vcov(model.rand)[2,2])))*2#
					est.list[i,4]<-(exp(-model.rand@beta[2]+1.96*sqrt(vcov(model.rand)[2,2])))*2					#
				}#
			} else {#
				est.list[i,2]<-(exp(-coef(model.rand)))*2#
				est.list[i,3]<-(exp(-coef(model.rand)-1.96*sqrt(vcov(model.rand))))*2#
				est.list[i,4]<-(exp(-coef(model.rand)+1.96*sqrt(vcov(model.rand))))*2				#
			}#
		}#
	#single model#
	} else {#
			if(is(model.fit)[1]=="glmerMod"){#
				if(dim(vcov(model.fit))[1]==1){#
					#absolute quantification#
					est.list[1,2]<-(exp(-model.fit@beta[1]))*2#
					est.list[1,3]<-(exp(-model.fit@beta[1]-1.96*sqrt(vcov(model.fit)[1,1])))*2#
					est.list[1,4]<-(exp(-model.fit@beta[1]+1.96*sqrt(vcov(model.fit)[1,1])))*2#
				} else {#
					#copy number variation#
					est.list[1,2]<-(exp(-model.fit@beta[2]))*2#
					est.list[1,3]<-(exp(-model.fit@beta[2]-1.96*sqrt(vcov(model.fit)[2,2])))*2#
					est.list[1,4]<-(exp(-model.fit@beta[2]+1.96*sqrt(vcov(model.fit)[2,2])))*2#
				}#
			} else {#
				#GLM only for absolute quantification with no replicates#
				est.list[1,2]<-(exp(-coef(model.fit)))*2#
				est.list[1,3]<-(exp(-coef(model.fit)-1.96*sqrt(vcov(model.fit))))*2#
				est.list[1,4]<-(exp(-coef(model.fit)+1.96*sqrt(vcov(model.fit))))*2				#
			}#
			est.list<-est.list[1,]#
	}#
	return(est.list)#
}#
determine.stability <- function(datamat){#
#
	ref.data<-datamat[datamat$target==F,]#
	ref.genes<-unique(ref.data$gene)#
	est<-array(NA,(length(ref.genes)-1))#
	est.low<-array(NA,(length(ref.genes)-1))#
	est.high<-array(NA,(length(ref.genes)-1))#
	gene<-array(NA,(length(ref.genes)-1))#
	stability <- data.frame(gene,est,est.low,est.high)#
	stab.genes<-list()#
	stab.summary<-matrix(NA,length(ref.genes),2)#
	for(i in 1:length(ref.genes)){#
		cat("Determining stability...\n\tReference gene ",i," of ",length(ref.genes),"\n\n")#
		target.ref.ID <- which(ref.data$gene==ref.genes[i])#
		target.ref.data <- ref.data[target.ref.ID,]#
		target.ref.data$target <- TRUE#
		ref.ref.data <- ref.data[-target.ref.ID,]#
		ref.ref.genes<-unique(ref.ref.data$gene)			#
		for(j in 1:length(ref.ref.genes)){#
			ref.ref.ID <- which(ref.ref.data$gene==ref.ref.genes[j])#
			data.subset <- rbind(target.ref.data,ref.ref.data[ref.ref.ID,])#
			stability[j,]<-get.estimates(data.subset,fit.set(data.subset))#
		}#
		stab.genes[[i]]<-stability#
		stab.summary[i,]<-c(mean(stab.genes[[i]]$est),sum((stab.genes[[i]]$est-2)^2))#
	}#
	stab.summary<-data.frame(as.character(ref.genes),stab.summary)#
	colnames(stab.summary)<-c("Gene","Mean","Deviation")#
	return(list(stab.genes,stab.summary))#
}#
#
plot.stability <- function(stability){#
	barplot(sort(abs(stability[[2]][,3])),names.arg=stability[[2]][,1][order(abs(stability[[2]][,3]))])#
}
data
datamat
datamat[c(1:3,27:29),]
test<-datamat[c(1:3,27:29),]
fit.set(test)
test
data<-read.csv("NIPDmerged.csv",sep=";")
datamat
read.csv("~/Dropbox/Work/matthijs-olivier/dpcr/cnvreplicates/Data/NIPD/datamat.csv")
datamat<-read.csv("~/Dropbox/Work/matthijs-olivier/dpcr/cnvreplicates/Data/NIPD/datamat.csv")
colnames(datamat)<-c("gene","pos","neg","target")
a<-fit.set(datamat[c(1:3,27:29),])
a
summary(a)
exp(-0.425)
exp(0.425)
exp(0.425)*2
datamat
datamat2<-datamat[1:6,]
datamat2
datamat2$target
datamat2$target<-c(T,T,T,F,F,F)
datamat2$target
a<-fit.set(datamat2)
datamat2
datamat2<-datamat2[1:5,]
a<-fit.set(datamat2)
summary(a)
exp(-0.04974)
exp(-0.04974)*2
exp(-1.80)
exp(1.80)
exp(2.20)
exp(-2.30)
exp(-2.40)
exp(-2.50)
q()
